

CREATE OR REPLACE PROCEDURE EUREKA.PR_CON_AHORROS
(
    P_SUCUARSAL IN VARCHAR2,
    P_AHORRO_SOLES OUT NUMBER,
    P_AHORRO_DOLARES OUT NUMBER,
    P_MENSAJE OUT VARCHAR2
)
IS
    V_SUMA_SOLES NUMBER(15);
    V_SUMA_DOLARES NUMBER(15);
BEGIN
    --VALIDAR
    SELECT NVL(SUM(C.DEC_CUENSALDO),0) 
	INTO V_SUMA_SOLES
    FROM EUREKA.CUENTA C, EUREKA.SUCURSAL SU
  
    WHERE 
	C.CHR_SUCUCODIGO = SU.CHR_SUCUCODIGO AND
	C.CHR_MONECODIGO = '01' AND
	C.CHR_SUCUCODIGO = P_SUCUARSAL;
    
    SELECT NVL(SUM(C.DEC_CUENSALDO),0) INTO V_SUMA_DOLARES
    FROM EUREKA.CUENTA C, EUREKA.SUCURSAL SU
  
    WHERE 
	C.CHR_SUCUCODIGO = SU.CHR_SUCUCODIGO AND
	C.CHR_MONECODIGO = '02' AND
	C.CHR_SUCUCODIGO = P_SUCUARSAL;
    
    
    IF V_SUMA_SOLES <> 1 THEN
    P_MENSAJE :=  'SOLES = ' || V_SUMA_SOLES || ' DOLARES =' || V_SUMA_DOLARES;

    RETURN;
    END IF;
    
    --PROCESO

    P_MENSAJE := 'NO EXISTE LA SUCURSAL' ;

END;
/

/*
CREATE OR REPLACE PROCEDURE SCOTT.PR_CON_AHORROS
(
    P_SUCURSAL IN NUMBER,
    P_AHORRO_SOLES OUT NUMBER,
    P_AHORRO_DOLARES OUT NUMBER,
    P_MENSAJE OUT VARCHAR2
)
IS

BEGIN
    --VALIDAR
    SELECT COUNT(1) INTO V_CONT
    FROM SCOTT.EMP
    WHERE EMPNO = P_CODIGO;
    
    IF V_CONT <> 1 THEN
    P_MENSAJE := 'NO EXISTE EL CODIGO';
    RETURN;
    END IF;
    
    --PROCESO
    SELECT SAL,COMM
    INTO P_SALARIO,P_COMISION
    FROM SCOTT.EMP
    WHERE EMPNO = P_CODIGO;
    P_MENSAJE :=  'OK';
END;
/*/